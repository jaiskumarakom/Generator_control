<html>
  <head>
    <title>ESP32 LED Control</title>
  </head>
  <body>
    <h1>ESP32 LED Control</h1>
    <p>LED is currently: 
      <span id="ledStatus">Loading...</span>  <!-- Initially displaying Loading -->
    </p>
    <button id="ledOnButton">Turn LED On</button>
    <button id="ledOffButton">Turn LED Off</button>

    <script>
      // Replace with your ESP32 IP address
      const ESP32_IP = "http://172.20.10.14";  // Replace with your ESP32 IP address

      // Function to update the LED status from the ESP32
      function updateLEDStatus() {
        fetch(`${ESP32_IP}/`)  // Request the root page to get the LED state
          .then(response => response.text())
          .then(data => {
            if (data.includes("LED is currently: ON")) {
              document.getElementById("ledStatus").textContent = "ON";
            } else if (data.includes("LED is currently: OFF")) {
              document.getElementById("ledStatus").textContent = "OFF";
            }
          })
          .catch(error => {
            console.error("Error fetching LED status:", error);
          });
      }

      // Add event listeners for the buttons
      document.getElementById("ledOnButton").addEventListener("click", function () {
        fetch(`${ESP32_IP}/led/on`)  // Request to turn on the LED
          .then(response => updateLEDStatus())  // Update LED status after action
          .catch(error => console.error('Error turning LED on:', error));
      });

      document.getElementById("ledOffButton").addEventListener("click", function () {
        fetch(`${ESP32_IP}/led/off`)  // Request to turn off the LED
          .then(response => updateLEDStatus())  // Update LED status after action
          .catch(error => console.error('Error turning LED off:', error));
      });

      // Initially update LED status when the page loads
      updateLEDStatus();
    </script>
  </body>
</html>
